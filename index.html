<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <title>Mint</title>
  <meta name="theme-color" content="#0ea5e9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Mint">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="manifest" href="manifest.webmanifest?v=53">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <style>
    :root{--bg:#0b1220;--fg:#e6eefc;--card:#111a33;--muted:#93a4bf;--accent:#0ea5e9;--line:rgba(255,255,255,.12)}
    @media (prefers-color-scheme:light){:root{--bg:#f6f8fc;--fg:#0b1220;--card:#fff;--muted:#5b6b86;--accent:#0ea5e9;--line:rgba(0,0,0,.12)}}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--fg)}
    header{position:fixed;top:0;left:0;right:0;background:#0ea5e9;padding:calc(12px + env(safe-area-inset-top)) 16px 12px;border-bottom:1px solid var(--line);z-index:5}
    h1{margin:0;font-size:18px;color:#ffffff}
    main{max-width:820px;margin:0 auto;padding:16pxpadding-bottom:60px;padding-top:calc(64px + env(safe-area-inset-top));}
    .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px}
    form.add{display:grid;grid-template-columns:1fr auto;gap:8px;margin-bottom:10px}
    input[type="text"],input[type="number"]{padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.05);color:var(--fg);outline:none}
    input[type="text"]:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(14,165,233,.25)}
    button{border:none;background:var(--accent);color:#fff;border-radius:10px;padding:10px 12px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid var(--line);color:var(--fg)}
    ul{list-style:none;padding:0;margin:0;display:grid;gap:8px}
    li.row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:rgba(255,255,255,.03);position:relative}
    .row .title{min-width:0;word-break:break-word}
    .actions{display:flex;gap:6px;position:relative;z-index:3}
    .row input[type="checkbox"]{width:18px;height:18px;position:relative;z-index:3}
    a.row-link{position:absolute;inset:0;border-radius:12px;color:inherit;text-decoration:none;z-index:1}
    .muted{color:var(--muted);font-size:13px}
    .breadcrumbs{margin-bottom:8px}
    .breadcrumbs a{color:inherit;text-decoration:none;opacity:.85}
    textarea{width:100%;min-height:160px;padding:12px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.05);color:var(--fg)}
    .note-thumb{max-width:96px;max-height:96px;border-radius:8px;border:1px solid var(--line)}
    .note-thumb-wrap{position:relative;display:inline-block}
    .note-del{position:absolute;top:4px;right:4px;background:#e11d48;color:#fff;border:none;border-radius:8px;padding:2px 6px;font-size:12px}
    #confirmModal,#pdfChoiceModal,#checklistParamsModal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:210}
    .modal-box{background:var(--card);padding:20px;border-radius:12px;max-width:360px;width:92%;box-shadow:0 6px 30px rgba(0,0,0,.45);display:grid;gap:14px}
    #tabs .active{ background:var(--accent); color:#fff; border-color:transparent; }
  
    /* Portrait-only overlay */
    #orientationLock{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#0b1220;color:#e6eefc;z-index:9999;text-align:center;padding:24px}
    #orientationLock .box{max-width:520px}
    #orientationLock h2{margin:0 0 8px;font-size:22px}
    #orientationLock p{margin:0;opacity:.8}
        
        /* Update bar */
        #updateBar{position:fixed;left:0;right:0;bottom:calc(12px + env(safe-area-inset-bottom));display:none;justify-content:center;z-index:120}
        #updateBar .inner{background:#111a33;border:1px solid var(--line);color:var(--fg);padding:10px 12px;border-radius:12px;display:flex;gap:10px;align-items:center;box-shadow:0 4px 18px rgba(0,0,0,.35)}
        #updateBar button{background:#0ea5e9;border:none;color:#fff;padding:8px 10px;border-radius:8px;font-weight:600}
        
    /* iOS keyboard fix */
    input[type="text"], input[type="number"], textarea {
      font-size:16px; /* prevents iOS from suppressing keyboard when user-scalable=no */
      -webkit-text-size-adjust: 100%;
      pointer-events:auto;
    }
    
    /* In-app PDF viewer overlay */
    #pdfViewer{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;flex-direction:column;z-index:220}
    #pdfViewer header{display:flex;align-items:center;gap:8px;padding:calc(2px + env(safe-area-inset-top)) 12px 8px;background:#0b1220;border-bottom:1px solid var(--line)}
    #pdfViewer header button{background:#0ea5e9;color:#fff;border:none;border-radius:10px;padding:8px 10px;font-weight:600}
    #pdfViewer header .ghost{background:transparent;border:1px solid var(--line);color:#e6eefc}
    #pdfViewer iframe{flex:1;border:0;width:100%;background:#fff}
        
.folders-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#f8fafc}
.folders-chip .del{border:0;background:transparent;opacity:.7}
.folders-empty{color:var(--muted);opacity:.9}
</style>
</head>
<body>
  <header><h1 id="appTitle">Mint</h1></header>
  <main>
<div id="updateBar"><div class="inner">–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è <button id="updateNowBtn">–û–±–Ω–æ–≤–∏—Ç—å</button></div></div>
    <!-- List -->
    <section id="view-list" class="card" hidden>
      <div id="tabs" style="display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;">
        <button id="tabActive" class="ghost">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
        <button id="tabDone" class="ghost">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</button>
        <button id="tabAll" class="ghost">–í—Å–µ</button>
      </div>
      <form id="addTask" class="add" autocomplete="off">
        <input id="taskTitle" type="text" maxlength="120" placeholder="–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞‚Ä¶" required>
        <button>–î–æ–±–∞–≤–∏—Ç—å</button>
      </form>
      <ul id="tasks" class="tasks"></ul>
      <p id="tasksEmpty" class="muted" hidden>–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç.</p>
    </section>

    <!-- Detail -->
    <section id="view-detail" class="card" hidden>
      <div class="breadcrumbs"><a href="#/">‚Üê –ó–∞–¥–∞—á–∏</a></div>
      <div class="muted" id="taskHeader"></div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 10px;">
        <button id="pdfBtn" class="ghost">PDF</button>
        <button id="renameTaskBtn" class="ghost">üìÅ –ü–∞–ø–∫–∞</button>
        <button id="deleteTaskBtn" class="ghost" style="border-color:#e11d48;color:#e11d48">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</button>
      </div>
      <form id="addSub" class="add" autocomplete="off">
        <input id="subTitle" type="text" maxlength="160" placeholder="–ù–æ–≤–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞‚Ä¶" required>
        <button>–î–æ–±–∞–≤–∏—Ç—å</button>
      </form>
      <div id="foldersBar" class="folders-bar" style="display:flex;flex-wrap:wrap;gap:8px;margin:6px 0;"></div>
<ul id="checkList" class="check"></ul>
      <p id="emptyCheck" class="muted" hidden>–ü–æ–¥–∑–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    </section>

    <!-- Note -->
    <section id="view-note" class="card" hidden>
      <nav class="breadcrumbs">
        <a href="#/">‚Üê –°–ø–∏—Å–æ–∫</a> / <a id="crumbTask" href="#">–ó–∞–¥–∞—á–∞</a> / <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</strong>
      </nav>
      <div style="display:grid;gap:10px;">
        <div><div class="muted">–ü–æ–¥–∑–∞–¥–∞—á–∞</div><div id="noteSubtaskText" style="font-weight:600;"></div></div>
        <label for="noteText" class="muted">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
          <button id="noteAttachBtn" class="ghost">üìé –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
          <input id="noteAttachInput" type="file" accept="image/*" capture="environment" style="display:none;">
          <div id="notePhotos" style="display:flex; gap:8px; flex-wrap:wrap;"></div>
        </div>
        <textarea id="noteText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–º–µ—Ç–∫—É‚Ä¶"></textarea>
        <div style="display:flex;gap:8px;justify-content:flex-end;">
          <button id="saveNoteBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
    </section>
  
    <div id="pdfViewer">
      <header>
        <button id="pdfCloseBtn">‚Üê –ù–∞–∑–∞–¥</button>
        <button id="pdfOpenSafari" class="ghost">–û—Ç–∫—Ä—ã—Ç—å –≤ Safari</button>
        <button id="pdfDownloadBtn" class="ghost">–°–∫–∞—á–∞—Ç—å</button>
      </header>
      <iframe id="pdfFrame" title="–ü—Ä–æ—Å–º–æ—Ç—Ä PDF/–ø–µ—á–∞—Ç–∏"></iframe>
    </div>
    </main>

  <!-- Confirm modal -->
  <div id="confirmModal" class="modal">
    <div class="modal-box">
      <div id="confirmText">–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å?</div>
      <div style="display:flex;gap:10px;justify-content:flex-end;">
        <button id="confirmCancel" class="ghost">–û—Ç–º–µ–Ω–∞</button>
        <button id="confirmOk" style="background:#e11d48;">–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- PDF Choice Modal -->
  <div id="pdfChoiceModal" class="modal">
    <div class="modal-box">
      <div style="font-weight:700">–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</div>
      <div style="display:grid;gap:10px;">
        <button id="optChecklist" class="ghost" style="display:flex;gap:10px;align-items:center;justify-content:flex-start;padding:12px;border-radius:10px;">
          <span>‚úÖ</span><div><div style="font-weight:600">–ß–µ–∫‚Äë–ª–∏—Å—Ç</div><div class="muted" style="font-size:12px">—Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞—Ç–∞–º–∏</div></div>
        </button>
        <button id="optDescription" class="ghost" style="display:flex;gap:10px;align-items:center;justify-content:flex-start;padding:12px;border-radius:10px;">
          <span>üìù</span><div><div style="font-weight:600">–û–ø–∏—Å–∞–Ω–∏–µ</div><div class="muted" style="font-size:12px">–ø–æ–¥–∑–∞–¥–∞—á–∏ + –ø—Ä–∏–º–µ—á–∞–Ω–∏—è + —Ñ–æ—Ç–æ</div></div>
        </button>
      </div>
      <div style="display:flex;justify-content:flex-end;">
        <button id="pdfChoiceCancel" class="ghost">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- Checklist Params Modal -->
  <div id="checklistParamsModal" class="modal">
    <div class="modal-box">
      <div style="font-weight:700">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ–∫‚Äë–ª–∏—Å—Ç–∞</div>
      <div style="display:grid;gap:10px;">
        <label class="muted" style="display:grid;gap:6px;">–ö–æ–ª-–≤–æ –¥–Ω–µ–π
          <input id="paramDays" type="number" min="1" max="60" value="7">
        </label>
        <label class="muted" style="display:grid;gap:6px;">–ü—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
          <input id="paramExtra" type="number" min="0" max="50" value="0">
        </label>
        <label class="muted" style="display:flex;align-items:center;gap:8px;">
          <input id="paramLandscape" type="checkbox"> –ê–ª—å–±–æ–º–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ)
        </label>
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end;">
        <button id="paramsCancel" class="ghost">–û—Ç–º–µ–Ω–∞</button>
        <button id="paramsCreate">–°–æ–∑–¥–∞—Ç—å PDF</button>
      </div>
    </div>
  </div>

  <div id="orientationLock"><div class="box"><h2>–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</h2><p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏.</p></div></div>
<script src="app.v60.js"></script>
</body>
</html>
